#!/usr/bin/env sh
set -e

PUID="${PUID:-0}"
PGID="${PGID:-0}"


if [ "$PUID" != 0 ]; then
  echo "Changing uid of $INVOICENINJA_USER to $PUID"
  echo "Changing gid of $INVOICENINJA_GROUP to $PGID"
  usermod -u "$PUID" "$INVOICENINJA_USER" 2>/dev/null && {
    groupmod -g "$PGID" "$INVOICENINJA_GROUP" 2>/dev/null ||
    usermod -a -G "$PGID" "$INVOICENINJA_GROUP"
  }

  chown -R "$INVOICENINJA_USER:$INVOICENINJA_GROUP" /var/www/app
  exec gosu "$INVOICENINJA_USER" docker-entrypoint "$@"
fi

exec docker-entrypoint "$@"
